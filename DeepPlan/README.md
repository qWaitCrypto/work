# 🧠 DeepPlan

> **类人认知多层级智能代理框架**  
> 一个拥有自我感知、任务规划、上下文记忆、成本感知与工具协作能力的 AI 智能体系统。

---

## 🚀 项目简介

**DeepPlan** 是一个致力于实现类人认知与行动逻辑的多层级智能代理系统。它不仅能“执行任务”，更能“理解任务”、“规划路径”、“动态协调资源”并“反思优化”。  
框架整合 AutoGen、LangGraph、LangChain、Semantic Kernel 等优秀开源技术，构建出拥有感知、规划、调度、记忆、工具接口五层能力的现代 AI Agent 系统。

---

## 🧱 系统架构

---

### **1. 感知与元认知层**  
**Perception & Meta-Cognition Layer**

#### ✅ 初衷：
我们认为一个真正“智能”的代理不应只是执行命令，而应该像人类一样，具备任务意识、目标识别、自我判断与反思能力。  
它应该知道“该不该做”、“值不值得做”、“我能不能做”，而不是无脑执行。这层是整个系统的**智能边界判断器**和“思考系统”。

#### 🧩 职责：
- 理解用户输入，识别背后的真实意图和任务结构；
- 判断当前系统能力是否胜任该任务；
- 预估任务资源（token、时间、工具、模型）；
- 判断是否执行、拒绝或请求人工协助；
- 执行过程中可回顾前序步骤，发现失败或偏差后**主动重构任务计划**；
- 支持任务复盘、元认知反馈。

#### 🛠️ 实现能力：
- 意图识别模块（如目标分类、复杂度识别）；
- 可行性评估规则（如 token 预算 / 是否需要人类知识）；
- Reflection 模块：对执行结果进行总结与重新判断；
- Replanner 模块：在失败或偏差下生成修复或替代任务路径。

---

### **2. 上下文与记忆管理层**  
**Context & Memory Layer**

#### ✅ 初衷：
当前 LLM 驱动的系统普遍存在 token 爆炸、上下文混乱、缺乏长期记忆等问题。我们希望通过有效的上下文压缩与记忆策略，让代理能“记得住、用得上、说得清”。

#### 🧩 职责：
- 管理当前对话窗口内短期上下文；
- 维护长期任务记忆（用户意图、已完成子任务、失败经验）；
- 在交互过程中动态剪枝、摘要、重构上下文，提升 token 利用效率；
- 支持多角色、多任务状态隔离。

#### 🛠️ 实现能力：
- Sliding window + 层级摘要策略（如 recursive summarization）；
- 任务阶段性总结生成；
- 向量数据库支持检索型长期记忆（结合 RAG）；
- 记忆标签化与检索：对历史任务打 tag，支持精确召回。

---

### **3. 任务规划与执行调度层**  
**Task Planning & Execution Orchestration Layer**

#### ✅ 初衷：
类人智能必须具备“先计划、后执行”的能力，而不是每次都“走一步算一步”。我们希望代理能像一个项目经理一样，先构建任务结构，然后调度各类资源完成。

#### 🧩 职责：
- 将用户目标拆解为结构化任务图（如树或 DAG）；
- 明确各子任务的粒度、依赖、顺序与并发关系；
- 对任务进行调度、执行状态监控、异常处理（失败回滚、重试）；
- 协调多个代理之间的交叉任务调用与结果传递。

#### 🛠️ 实现能力：
- 内部 TaskGraph / DAG 构建器；
- 子任务节点类型标注（是否需要工具、模型、数据）；
- 执行调度器（结合异步框架/任务队列）；
- 执行失败管理器（Retry / Fallback / Escalate）；
- Agent 流程控制支持（如 AutoGen GroupChat 式多角色协作）。

---

### **4. 模型与算力调度层**  
**Model & Compute Routing Layer**

#### ✅ 初衷：
LLM 调用成本高昂，不同任务不需要使用相同等级的模型。我们希望智能代理能根据任务类型、优先级、预算等因素**自动选择合适的大模型组合**，以最优成本完成任务。

#### 🧩 职责：
- 根据任务属性选择不同模型；
- 控制推理成本上限（如每日额度 / 最大 token / 最长响应时间）；
- 支持模型动态路由、组合调用；
- 多模型之间结果对齐与验证。

#### 🛠️ 实现能力：
- 基于任务结构图和复杂度标注进行模型路由；
- 多模型封装统一接口（OpenAI、Anthropic、Gemini、Mistral 等）；
- 支持模型响应融合（如低模快速生成 + 高模验证）；
- 成本管理器：限制模型调用频率 / token 消耗等；

---

### **5. 工具与环境接口层**  
**Tool & External Interface Layer**

#### ✅ 初衷：
Agent 的智能不仅在“说”，更在于“做”。它必须能像人一样调用真实世界的工具。我们设计此层的初衷是：赋予智能体强大的行动能力，像开发者一样与环境互动。

#### 🧩 职责：
- 管理所有可用外部工具（如搜索、执行器、API）；
- 提供标准化调用接口，支持任务自动分配到合适工具；
- 支持工具调用的权限管理、日志追踪、安全控制；
- 工具调用失败后的备选策略（Fallback、手动模式等）。

#### 🛠️ 实现能力：
- 接入：Python Code Interpreter、Shell、Browser、API 接口、区块链节点、数据库、自动表单等；
- LangChain 风格的 Tool 封装系统；
- Tool Selection Agent：为子任务自动选择最合适的工具；
- 工具调用日志 + 状态回传机制，供上层反思与反馈模块使用。

---

### ✅ 结语

这五个模块围绕一个核心哲学构建：**类人智能不是“执行器”，而是“理解者 + 策划者 + 行动者 + 反思者”。**  
我们相信，拥有感知、记忆、规划、调度、执行的完整闭环，才是迈向通用智能代理的正确路径。


---

## ✨ 关键特性

- 🧠 类人认知结构：具有“感知 - 规划 - 行动 - 反思”的完整智能决策流；
- 🧩 模块化设计：每层逻辑解耦、可独立优化或替换；
- ⚡ 多模型调度：按需调用 GPT-3.5 / GPT-4 / Claude / Gemini 等大模型；
- 🧠 自我优化：可自我总结、修正任务计划并持续演化；
- 🛠️ 丰富工具链支持：内置浏览器、搜索引擎、Python 执行器、API 插件等；
- 📦 快速接入 AutoGen / LangChain / LangGraph / Semantic Kernel 等生态。

---

## 🛠 快速开始（开发中）

> 🚧 本框架正在快速开发中，以下为设计阶段入口示例

```bash
# 安装依赖（建议使用虚拟环境）
pip install -r requirements.txt

# 启动示例代理运行（开发版本）
python demo/deepplan_main.py
